!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(jQuery||require("jquery")):e(jQuery)}(function(we){we.fn.jScrollPane=function(o){function s(j,e){var m,w,y,k,b,T,C,x,S,H,D,B,P,z,A,W,Y,M,X,t,R,L,E,I,F,V,q,O,G,N,K,Q,U,$,J=this,n=!0,r=!0,a=!1,l=!1,o=j.clone(!1,!1).empty(),Z=!1,_=we.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp",ee=function(){0<m.resizeSensorDelay?setTimeout(function(){te(m)},m.resizeSensorDelay):te(m)};function te(e){var t,o,s,i,n,r,a,l,c,p,d,u,f,h,g=!1,v=!1;if(m=e,void(o=t=0)===w)s=j.scrollTop(),i=j.scrollLeft(),j.css({overflow:"hidden",padding:"0"}),y=j.innerWidth(),k=j.innerHeight(),j.width(y),w=we('<div class="jspPane"></div>').css("padding",Q).append(j.children()),b=we('<div class="jspContainer"></div>').css({width:y+"px",height:k+"px"}).append(w).appendTo(j),m.autoHide&&b.addClass("jspAutoHide");else{if(j.css("width",""),b.css({width:"auto",height:"auto"}),w.css("position","static"),n=j.innerWidth()+U,r=j.innerHeight(),w.css("position","absolute"),g=m.stickToBottom&&(l=C-k,1!=m.maintainPosition||20<=l&&l-je()<10),v=m.stickToRight&&(a=T-y,1!=m.maintainPosition||20<=a&&a-ve()<10),a=n!==y||r!==k,y=n,k=r,b.css({width:y+"px",height:k+"px"}),!a&&$==T&&w.outerHeight()==C)return void j.width(y);$=T,w.css("width",""),j.width(y),b.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}w.css("overflow","auto"),T=e.contentWidth||w[0].scrollWidth,C=w[0].scrollHeight,w.css("overflow",""),x=T/y,H=1<(S=C/k)||m.alwaysShowVScroll,(D=1<x||m.alwaysShowHScroll)||H?(j.addClass("jspScrollable"),m.maintainPosition&&(z||Y)&&(t=ve(),o=je()),H&&(b.append(we('<div class="jspVerticalBar"></div>').append(we('<div class="jspCap jspCapTop"></div>'),we('<div class="jspTrack"></div>').append(we('<div class="jspDrag"></div>').append(we('<div class="jspDragTop"></div>'),we('<div class="jspDragBottom"></div>'))),we('<div class="jspCap jspCapBottom"></div>'))),M=b.find(">.jspVerticalBar"),X=M.find(">.jspTrack"),B=X.find(">.jspDrag"),m.showArrows&&(E=we('<a class="jspArrow jspArrowUp"></a>').on("mousedown.jsp",re(0,-1)).on("click.jsp",me),I=we('<a class="jspArrow jspArrowDown"></a>').on("mousedown.jsp",re(0,1)).on("click.jsp",me),m.arrowScrollOnHover&&(E.on("mouseover.jsp",re(0,-1,E)),I.on("mouseover.jsp",re(0,1,I))),ne(X,m.verticalArrowPositions,E,I)),R=k,b.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){R-=we(this).outerHeight()}),B.on("mouseenter",function(){B.addClass("jspHover")}).on("mouseleave",function(){B.removeClass("jspHover")}).on("mousedown.jsp",function(e){we("html").on("dragstart.jsp selectstart.jsp",me),B.addClass("jspActive");var t=e.pageY-B.position().top;return we("html").on("mousemove.jsp",function(e){ce(e.pageY-t,!1)}).on("mouseup.jsp mouseleave.jsp",le),!1}),se()),D&&(b.append(we('<div class="jspHorizontalBar"></div>').append(we('<div class="jspCap jspCapLeft"></div>'),we('<div class="jspTrack"></div>').append(we('<div class="jspDrag"></div>').append(we('<div class="jspDragLeft"></div>'),we('<div class="jspDragRight"></div>'))),we('<div class="jspCap jspCapRight"></div>'))),F=b.find(">.jspHorizontalBar"),V=F.find(">.jspTrack"),A=V.find(">.jspDrag"),m.showArrows&&(G=we('<a class="jspArrow jspArrowLeft"></a>').on("mousedown.jsp",re(-1,0)).on("click.jsp",me),N=we('<a class="jspArrow jspArrowRight"></a>').on("mousedown.jsp",re(1,0)).on("click.jsp",me),m.arrowScrollOnHover&&(G.on("mouseover.jsp",re(-1,0,G)),N.on("mouseover.jsp",re(1,0,N))),ne(V,m.horizontalArrowPositions,G,N)),A.on("mouseenter",function(){A.addClass("jspHover")}).on("mouseleave",function(){A.removeClass("jspHover")}).on("mousedown.jsp",function(e){we("html").on("dragstart.jsp selectstart.jsp",me),A.addClass("jspActive");var t=e.pageX-A.position().left;return we("html").on("mousemove.jsp",function(e){de(e.pageX-t,!1)}).on("mouseup.jsp mouseleave.jsp",le),!1}),q=b.innerWidth(),ie()),function(){{var e,t;D&&H&&(e=V.outerHeight(),t=X.outerWidth(),R-=e,we(F).find(">.jspCap:visible,>.jspArrow").each(function(){q+=we(this).outerWidth()}),q-=t,k-=t,y-=e,V.parent().append(we('<div class="jspCorner"></div>').css("width",e+"px")),se(),ie())}D&&w.width(b.outerWidth()-U+"px");C=w.outerHeight(),m.autoHide&&(e=V?V.outerHeight():0,C=w.outerHeight()-e);S=C/k,D&&((O=Math.ceil(1/x*q))>m.horizontalDragMaxWidth?O=m.horizontalDragMaxWidth:O<m.horizontalDragMinWidth&&(O=m.horizontalDragMinWidth),A.css("width",O+"px"),W=q-O,ue(Y));H&&((L=Math.ceil(1/S*R))>m.verticalDragMaxHeight?L=m.verticalDragMaxHeight:L<m.verticalDragMinHeight&&(L=m.verticalDragMinHeight),B.css("height",L+"px"),P=R-L,pe(z))}(),(m.stickToBottom||m.stickToRight)&&(he(v?T-y:t,!1),fe(g?C-k:o,!1)),w.find(":input,a").off("focus.jsp").on("focus.jsp",function(e){ge(e.target,!1)}),b.off(_).on(_,function(e,t,o,s){var i=Y=Y||0,n=z=z||0,e=e.deltaFactor||m.mouseWheelSpeed;return J.scrollBy(o*e,-s*e,!1),i==Y&&n==z}),h=!1,b.off("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").on("touchstart.jsp",function(e){e=e.originalEvent.touches[0];c=ve(),p=je(),d=e.pageX,u=e.pageY,h=!(f=!1)}).on("touchmove.jsp",function(e){if(h){var t=e.originalEvent.touches[0],o=Y,e=z;return J.scrollTo(c+d-t.pageX,p+u-t.pageY),f=f||5<Math.abs(d-t.pageX)||5<Math.abs(u-t.pageY),o==Y&&e==z}}).on("touchend.jsp",function(e){h=!1}).on("click.jsp-touchclick",function(e){if(f)return f=!1}),m.enableKeyboardNavigation&&function(){var s,i,n=[];D&&n.push(F[0]);H&&n.push(M[0]);w.on("focus.jsp",function(){j.focus()}),j.attr("tabindex",0).off("keydown.jsp keypress.jsp").on("keydown.jsp",function(e){if(e.target===this||n.length&&we(e.target).closest(n).length){var t=Y,o=z;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=e.keyCode,r();break;case 35:fe(C-k),s=null;break;case 36:fe(0),s=null}return!(i=e.keyCode==s&&t!=Y||o!=z)}}).on("keypress.jsp",function(e){if(e.keyCode==s&&r(),e.target===this||n.length&&we(e.target).closest(n).length)return!i}),m.hideFocus?(j.css("outline","none"),"hideFocus"in b[0]&&j.attr("hideFocus",!0)):(j.css("outline",""),"hideFocus"in b[0]&&j.attr("hideFocus",!1));function r(){var e=Y,t=z;switch(s){case 40:J.scrollByY(m.keyboardSpeed,!1);break;case 38:J.scrollByY(-m.keyboardSpeed,!1);break;case 34:case 32:J.scrollByY(k*m.scrollPagePercent,!1);break;case 33:J.scrollByY(-k*m.scrollPagePercent,!1);break;case 39:J.scrollByX(m.keyboardSpeed,!1);break;case 37:J.scrollByX(-m.keyboardSpeed,!1)}return i=e!=Y||t!=z}}(),m.clickOnTrack&&function(){ae(),H&&X.on("mousedown.jsp",function(s){if(void 0===s.originalTarget||s.originalTarget==s.currentTarget){var i,n=we(this),e=n.offset(),r=s.pageY-e.top-z,a=!0,l=function(){var e=n.offset(),t=s.pageY-e.top-L/2,o=k*m.scrollPagePercent,e=P*o/(C-k);if(r<0)t<z-e?J.scrollByY(-o):ce(t);else{if(!(0<r))return void c();z+e<t?J.scrollByY(o):ce(t)}i=setTimeout(l,a?m.initialDelay:m.trackClickRepeatFreq),a=!1},c=function(){i&&clearTimeout(i),i=null,we(document).off("mouseup.jsp",c)};return l(),we(document).on("mouseup.jsp",c),!1}});D&&V.on("mousedown.jsp",function(s){if(void 0===s.originalTarget||s.originalTarget==s.currentTarget){var i,n=we(this),e=n.offset(),r=s.pageX-e.left-Y,a=!0,l=function(){var e=n.offset(),t=s.pageX-e.left-O/2,o=y*m.scrollPagePercent,e=W*o/(T-y);if(r<0)t<Y-e?J.scrollByX(-o):de(t);else{if(!(0<r))return void c();Y+e<t?J.scrollByX(o):de(t)}i=setTimeout(l,a?m.initialDelay:m.trackClickRepeatFreq),a=!1},c=function(){i&&clearTimeout(i),i=null,we(document).off("mouseup.jsp",c)};return l(),we(document).on("mouseup.jsp",c),!1}})}(),function(){if(location.hash&&1<location.hash.length){var e,t,o=escape(location.hash.substr(1));try{e=we("#"+o+', a[name="'+o+'"]')}catch(e){return}e.length&&w.find(o)&&(0===b.scrollTop()?t=setInterval(function(){0<b.scrollTop()&&(ge(e,!0),we(document).scrollTop(b.position().top),clearInterval(t))},50):(ge(e,!0),we(document).scrollTop(b.position().top)))}}(),m.hijackInternalLinks&&(we(document.body).data("jspHijack")||(we(document.body).data("jspHijack",!0),we(document.body).delegate('a[href*="#"]',"click",function(e){var t,o=this.href.substr(0,this.href.indexOf("#")),s=location.href;if(o===(s=-1!==location.href.indexOf("#")?location.href.substr(0,location.href.indexOf("#")):s)){o=escape(this.href.substr(this.href.indexOf("#")+1));try{t=we("#"+o+', a[name="'+o+'"]')}catch(e){return}t.length&&((s=t.closest(".jspScrollable")).data("jsp").scrollToElement(t,!0),s[0].scrollIntoView&&(o=we(window).scrollTop(),((t=t.offset().top)<o||t>o+we(window).height())&&s[0].scrollIntoView()),e.preventDefault())}})))):(j.removeClass("jspScrollable"),w.css({top:"0",left:"0",width:b.width()-U}),b.off(_),w.find(":input,a").off("focus.jsp"),j.attr("tabindex","-1").removeAttr("tabindex").off("keydown.jsp keypress.jsp"),w.off(".jsp"),ae()),m.resizeSensor||!m.autoReinitialise||K?m.resizeSensor||m.autoReinitialise||!K||clearInterval(K):K=setInterval(function(){te(m)},m.autoReinitialiseDelay),m.resizeSensor&&!Z&&(oe(w,ee),oe(j,ee),oe(j.parent(),ee),window.addEventListener("resize",ee),Z=!0),s&&j.scrollTop(0)&&fe(s,!1),i&&j.scrollLeft(0)&&he(i,!1),j.trigger("jsp-initialised",[D||H])}function oe(e,t){var o,s,i=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div");i.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",n.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",a.style.cssText="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: scroll; z-index: -1; visibility: hidden;",r.style.cssText="position: absolute; left: 0; top: 0;",l.style.cssText="position: absolute; left: 0; top: 0; width: 200%; height: 200%;";function c(){r.style.width=n.offsetWidth+10+"px",r.style.height=n.offsetHeight+10+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight,o=e.width(),s=e.height()}n.addEventListener("scroll",function(){(e.width()>o||e.height()>s)&&t.apply(this,[]),c()}.bind(this)),a.addEventListener("scroll",function(){(e.width()<o||e.height()<s)&&t.apply(this,[]),c()}.bind(this)),n.appendChild(r),a.appendChild(l),i.appendChild(n),i.appendChild(a),e.append(i),"static"===window.getComputedStyle(e[0],null).getPropertyValue("position")&&(e[0].style.position="relative"),c()}function se(){X.height(R+"px"),z=0,t=m.verticalGutter+X.outerWidth(),m.autoHide?w.width(y):w.width(y-t-U);try{0===M.position().left&&w.css("margin-left",t+"px")}catch(e){}}function ie(){b.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){q-=we(this).outerWidth()}),V.width(q+"px"),Y=0}function ne(e,t,o,s){var i="before",n="after";(t="os"==t?/Mac/.test(navigator.platform)?"after":"split":t)==i?n=t:t==n&&(i=t,t=o,o=s,s=t),e[i](o)[n](s)}function re(e,t,o){return function(){return function(e,t,o,s){o=we(o).addClass("jspActive");var i,n,r=!0,a=function(){0!==e&&J.scrollByX(e*m.arrowButtonSpeed),0!==t&&J.scrollByY(t*m.arrowButtonSpeed),n=setTimeout(a,r?m.initialDelay:m.arrowRepeatFreq),r=!1};a(),i=s?"mouseout.jsp":"mouseup.jsp",(s=s||we("html")).on(i,function(){o.removeClass("jspActive"),n&&clearTimeout(n),n=null,s.off(i)})}(e,t,this,o),this.blur(),!1}}function ae(){V&&V.off("mousedown.jsp"),X&&X.off("mousedown.jsp")}function le(){we("html").off("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),B&&B.removeClass("jspActive"),A&&A.removeClass("jspActive")}function ce(e,t){var o,s,i,n;H&&(e<0?e=0:P<e&&(e=P),o=new we.Event("jsp-will-scroll-y"),j.trigger(o,[e]),o.isDefaultPrevented()||(s=0===(o=e||0),i=o==P,n=-(e/P)*(C-k),(t=void 0===t?m.animateScroll:t)?J.animate(B,"top",e,pe,function(){j.trigger("jsp-user-scroll-y",[-n,s,i])}):(B.css("top",e+"px"),pe(e),j.trigger("jsp-user-scroll-y",[-n,s,i]))))}function pe(e){void 0===e&&(e=B.position().top),b.scrollTop(0);var t,o=0===(z=e||0),s=z==P,i=-(e/P)*(C-k);n==o&&a==s||(n=o,a=s,j.trigger("jsp-arrow-change",[n,a,r,l])),t=o,e=s,m.showArrows&&(E[t?"addClass":"removeClass"]("jspDisabled"),I[e?"addClass":"removeClass"]("jspDisabled")),w.css("top",i+"px"),j.trigger("jsp-scroll-y",[-i,o,s]).trigger("scroll")}function de(e,t){var o,s,i,n;D&&(e<0?e=0:W<e&&(e=W),o=new we.Event("jsp-will-scroll-x"),j.trigger(o,[e]),o.isDefaultPrevented()||(s=0===(o=e||0),i=o==W,n=-(e/W)*(T-y),(t=void 0===t?m.animateScroll:t)?J.animate(A,"left",e,ue,function(){j.trigger("jsp-user-scroll-x",[-n,s,i])}):(A.css("left",e+"px"),ue(e),j.trigger("jsp-user-scroll-x",[-n,s,i]))))}function ue(e){void 0===e&&(e=A.position().left),b.scrollTop(0);var t,o=0===(Y=e||0),s=Y==W,i=e/W,e=-i*(T-y);m.autoHide&&(t=X?X.outerWidth():0,e=-i*(T-y-t)),r==o&&l==s||(r=o,l=s,j.trigger("jsp-arrow-change",[n,a,r,l])),i=o,t=s,m.showArrows&&(G[i?"addClass":"removeClass"]("jspDisabled"),N[t?"addClass":"removeClass"]("jspDisabled")),w.css("left",e+"px"),j.trigger("jsp-scroll-x",[-e,o,s]).trigger("scroll")}function fe(e,t){ce(e/(C-k)*P,t)}function he(e,t){de(e/(T-y)*W,t)}function ge(e,t,o){var s,i,n,r,a,l=0,c=0;try{s=we(e)}catch(e){return}for(i=s.outerHeight(),n=s.outerWidth(),b.scrollTop(0),b.scrollLeft(0);!s.is(".jspPane");)if(l+=s.position().top,c+=s.position().left,s=s.offsetParent(),/^body|html$/i.test(s[0].nodeName))return;l<(e=je())||t?r=l-m.horizontalGutter:e+k<l+i&&(r=l-k+i+m.horizontalGutter),isNaN(r)||fe(r,o),c<(r=ve())||t?a=c-m.horizontalGutter:r+y<c+n&&(a=c-y+n+m.horizontalGutter),isNaN(a)||he(a,o)}function ve(){return-w.position().left}function je(){return-w.position().top}function me(){return!1}U="border-box"===j.css("box-sizing")?Q=0:(Q=j.css("paddingTop")+" "+j.css("paddingRight")+" "+j.css("paddingBottom")+" "+j.css("paddingLeft"),(parseInt(j.css("paddingLeft"),10)||0)+(parseInt(j.css("paddingRight"),10)||0)),we.extend(J,{reinitialise:function(e){te(e=we.extend({},m,e))},scrollToElement:function(e,t,o){ge(e,t,o)},scrollTo:function(e,t,o){he(e,o),fe(t,o)},scrollToX:function(e,t){he(e,t)},scrollToY:function(e,t){fe(e,t)},scrollToPercentX:function(e,t){he(e*(T-y),t)},scrollToPercentY:function(e,t){fe(e*(C-k),t)},scrollBy:function(e,t,o){J.scrollByX(e,o),J.scrollByY(t,o)},scrollByX:function(e,t){de((ve()+Math[e<0?"floor":"ceil"](e))/(T-y)*W,t)},scrollByY:function(e,t){ce((je()+Math[e<0?"floor":"ceil"](e))/(C-k)*P,t)},positionDragX:function(e,t){de(e,t)},positionDragY:function(e,t){ce(e,t)},animate:function(e,t,o,s,i){var n={};n[t]=o,e.animate(n,{duration:m.animateDuration,easing:m.animateEase,queue:!1,step:s,complete:i})},getContentPositionX:ve,getContentPositionY:je,getContentWidth:function(){return T},getContentHeight:function(){return C},getPercentScrolledX:function(){return ve()/(T-y)},getPercentScrolledY:function(){return je()/(C-k)},getIsScrollableH:function(){return D},getIsScrollableV:function(){return H},getContentPane:function(){return w},scrollToBottom:function(e){ce(P,e)},hijackInternalLinks:we.noop,destroy:function(){var e,t;e=je(),t=ve(),j.removeClass("jspScrollable").off(".jsp"),w.off(".jsp"),j.replaceWith(o.append(w.children())),o.scrollTop(e),o.scrollLeft(t),K&&clearInterval(K)}}),te(e)}return o=we.extend({},we.fn.jScrollPane.defaults,o),we.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){o[this]=o[this]||o.speed}),this.each(function(){var e=we(this),t=e.data("jsp");t?t.reinitialise(o):(we("script",e).filter('[type="text/javascript"],:not([type])').remove(),t=new s(e,o),e.data("jsp",t))})},we.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8,alwaysShowVScroll:!1,alwaysShowHScroll:!1,resizeSensor:!1,resizeSensorDelay:0}});